@using System.Configuration
@using LinkIt.BubbleSheetPortal.Web.Helpers
@model LinkIt.BubbleSheetPortal.Web.ViewModels.RegistrationViewModel
@{
    ViewBag.Title = "Registration";
}
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    @{
        var strWhiteLable = string.Empty;
        var WhiteHtmlInFolder = string.Empty;
        var strWhiteHtmlBanner = string.Empty;

        var vS3URL = HelperExtensions.GetS3CSSURL();
        var districtId = 0;
        //if (Request.IsAuthenticated)
        //{
        //    districtId = HelperExtensions.GetDistrictIdBySubdomain();
        //}
        districtId = HelperExtensions.DistrictIdBySubDomain;
        if (!string.IsNullOrEmpty(vS3URL))
        {
            //strWhiteLable = string.Format("{0}{1}.css", vS3URL, HelperExtensions.LoginDistrict);
            strWhiteLable = string.Format("{0}{1}.css", vS3URL, districtId);
        }
        //if (!File.Exists(Request.MapPath("~/Content/css/district/" + districtID + ".css")))
        //{
        //    districtID = 0;
        //}
    }
    <title>Council for Economic Education</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    @Html.Partial("_Favicons")
    <!-- Mobile Specific Metas
        ================================================ -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <script src="@Url.Content("~/Scripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.11.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/themes/Constellation/js/html5.js")" type="text/javascript"></script>
    @*@MvcHtmlString.Create(
            Bundle.Css()
                .Add(@Url.Content("~/Content/themes/Constellation/css/reset.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/common.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/custom.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/form.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/standard.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/special-pages.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/calendars.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/960.gs.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/table.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/block-lists.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/simple-lists.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/wizard.css"))
                .Add(@Url.Content("~/Content/themes/Constellation/css/gallery.css"))
                .Add(@Url.Content("~/Content/css/custom.css"))
                .Add(@Url.Content("~/Content/css/prettyPhoto.css"))
                .Add(@Url.Content("~/Content/css/utilitySearch.css"))
                .Add(@Url.Content("~/Content/css/skeleton.css"))
                .Add(@Url.Content("~/Content/css/new-general.css"))
            //.Add(@Url.Content("~/Content/css/registration.css"))
                .Add(@Url.Content("~/Content/themes/base/jquery.ui.all.css"))
                .Add(@Url.Content("~/Content/themes/base/jquery.ui.theme.css"))
                .Add(@Url.Content("~/Content/themes/base/jquery.ui.core.css"))
                .Add(@Url.Content("~/Content/themes/base/jquery.ui.dialog.css"))
            //.Add(@Url.Content("~/Content/css/district/" + districtID + ".css"))
                .Add(@Url.Content("~/Content/themes/base/jquery.ui.datepicker.css"))
            //.Add(@Url.Content("~/Content/themes/base/jquery.ui.theme.css"))
                .Render("/Content/themes/Constellation/css/combined_#.css")

            )*@

    @LinkIt.BubbleSheetPortal.Web.Helpers.BundleHelper.StyleRegistrationBundle()

    @*@MvcHtmlString.Create(
            Bundle.JavaScript()
                .Add("/Content/themes/Constellation/js/html5.js")
                .Add("/Content/themes/Constellation/js/old-browsers.js")
                .Add("/Content/themes/Constellation/js/jquery.accessibleList.js")
                .Add("/Content/themes/Constellation/js/searchField.js")
                .Add("/Content/themes/Constellation/js/common.js")
                .Add("/Content/themes/Constellation/js/standard.js")
                .Add("/Content/themes/Constellation/js/jquery.tip.js")
                .Add("/Content/themes/Constellation/js/jquery.hashchange.js")
                .Add("/Content/themes/Constellation/js/jquery.contextMenu.js")
                .Add("/Content/themes/Constellation/js/jquery.modal.js")
                .Add("/Content/themes/Constellation/js/list.js")
                .Add("/Content/themes/Constellation/js/jquery.datepick/jquery.datepick.min.js")
                .Add("/Scripts/jquery.maskedinput-1.2.2.js")
                .Add("/Scripts/underscore.js")
                .Add("/Scripts/jquery.dataTables-1.9.4.js")
                .Add("/Scripts/custom.js")
                .Add("/Scripts/BlockUI.js")
                .Add("/Scripts/prettyPhoto/jquery.prettyPhoto.js")
                .Add("/Scripts/date.js")
                .Add("/Scripts/jquery.form.js")
                .Render("/Content/themes/Constellation/js/combined_#.js")
            )*@

    @LinkIt.BubbleSheetPortal.Web.Helpers.BundleHelper.ScriptRegistrationBundle()

    <style>
        input:required {
            box-shadow: none;
        }

        input:invalid {
            box-shadow: none;
        }

        .teacherRegistration-terms {
            background: #f1f1f1;
            padding: 10px;
        }

        .teacherRegistration-terms-content {
            background: #fff;
            height: 80px;
            overflow-x: hidden;
            margin: 10px 0;
            padding: 10px;
        }

            .teacherRegistration-terms-content p {
                margin: 0 0 1em 0;
            }

        .teacherRegistration-terms-argree input[type="checkbox"] {
            display: inline-block;
            vertical-align: middle;
            position: relative;
            top: -1px;
            margin-right: 3px;
        }

        .teacherRegistration-terms-argree input[type="checkbox"],
        .teacherRegistration-terms-argree label {
            cursor: pointer;
        }

        .u-w-125 {
            width: 125px;
        }

        .u-text-right {
            text-align: right;
            margin-top: -10px;
        }
    </style>
    <script>
        $(function () {
            $('#password').blur(function () {
                var regex = new RegExp('@ConfigurationManager.AppSettings["PasswordRegex"]');
                var errorMessage = '@ConfigurationManager.AppSettings["PasswordRequirements"]';
                if (regex.test($(this).val())) {
                    $('#error-messages').hide();
                    $('#error-messages').empty();
                }
                else {
                    $('#error-messages').empty();
                    $('#error-messages').append('<li>' + errorMessage + '</li>');
                    $('#error-messages').show();
                }
            });

            $('#idchbTermsOfUse').on('click', function () {
                var $self = $(this);
                var $btnRegister = $('#btnRegister')
                if ($self.is(':checked')) {
                    $btnRegister.prop('disabled', false);
                } else {
                    $btnRegister.prop('disabled', true);
                }
            });
        });
        function RegisterTeacher() {

            var vFirstName = $('#FirstName').val().trim();
            var vLastName = $('#LastName').val().trim();
            var vEmail = $('#Email').val().trim();

            $('#btnRegister').disableBt();
            ShowBlock($("#registerCEE"), "Wait");

            $('#success-message').hide();
            $.post('@Url.Action("RegisterTeacher")', { UserName: '@Model.UserName', FirstName: vFirstName, LastName: vLastName, Email: vEmail, PassWord: $('#password').val(), ConfirmPassword: $('#ConfirmPassword').val(), TermsofUse: $("#idchbTermsOfUse").is(':checked') }, function (response) {
                if (response.Success == true) {
                    location.href = "/Account/SetAccountInformation/?id=" + response.userId + "&pw=false";
                } else {
                    addErrorMessages(response);
                    $('#error-messages').show();
                    $("#registerCEE").unblock();
                    $('#btnRegister').enableBt();
                }
            });
        }

        function GoBackURL(strurl) {
            window.location = strurl;
        }

        function ClearMessage() {
            $('#success-message').hide();
            $('#error-messages').hide();
        }


    </script>
</head>
<body>
    <div class="clear"></div>
    <div class="headerRegistration">
        <div class="container">
            @if (!string.IsNullOrEmpty(vS3URL))
            {

                strWhiteHtmlBanner = string.Format("{0}{1}/RegBanner.html", vS3URL, districtId);
                var htmlBanner = Html.DisplayStaticHtml(strWhiteHtmlBanner);
                if (htmlBanner == null || string.IsNullOrWhiteSpace(htmlBanner.ToHtmlString()))
                {
                    var whiteHtmlDefault = string.Format("{0}{1}.html", vS3URL, districtId);
                    htmlBanner = Html.DisplayStaticHtml("");
                }
                <div>@htmlBanner<div class="clear"></div></div>
            }
        </div>
    </div>
    <div class="clear"></div>
    <div class="mainRegistration" style="padding-top: 5px !important;">
        <div class="bgImage"></div>
        <div class="main"></div>
        <article class="container">
            <section class="ten tenfix columns topMain">
                <div id="registerCEE" class='block-border'>
                    <div class='block-content block-content bubbleSheetSelector' style="text-align: center;">
                        @if (string.IsNullOrEmpty(Model.MessageError))
                        {
                            <div class="teacherRegistration">
                                <h1>Teacher Registration</h1>
                                <br />
                                <ul style="display: none; margin-bottom: 10px; text-align: left;" id="error-messages" class="message error"></ul>
                                <ul style="display: none; margin-bottom: 10px; text-align: left;" id="success-message" class="message success"></ul>
                                <table class="table" width="100%">
                                    <tr>
                                        <td class="u-w-125">First Name</td>
                                        <td>
                                            @Html.TextBoxFor(x => x.FirstName, new { @class = "full-width", tabindex = 5, })
                                            @Html.ValidationMessageFor(x => x.FirstName, " ")
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="u-w-125">Last Name</td>
                                        <td>
                                            @Html.TextBoxFor(x => x.LastName, new { @class = "full-width", tabindex = 6 })
                                            @Html.ValidationMessageFor(x => x.LastName, " ")
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="u-w-125">Email</td>
                                        <td>
                                            <input type="email" class="full-width" tabindex=7 id="Email" name="Email" value="@Model.Email" />
                                            @*@Html.TextBoxFor(x => x.Email, new { @class = "full-width", tabindex = 7 })
                                                @Html.ValidationMessageFor(x => x.Email, " ")*@
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="u-w-125">Password</td>
                                        <td>
                                            @Html.TextBoxFor(x => x.Password, new { @class = "full-width", tabindex = 8, id = "password", type = "password" })
                                            @Html.ValidationMessageFor(x => x.Password, " ")
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="u-w-125">Confirm Password</td>
                                        <td>
                                            @Html.TextBoxFor(x => x.ConfirmPassword, new { @class = "full-width", tabindex = 9, type = "password" })
                                            @Html.ValidationMessageFor(x => x.ConfirmPassword, " ")
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div class="teacherRegistration-terms">
                                                <span>Terms Of Use:</span>
                                                <div class="teacherRegistration-terms-content">
                                                    @Html.Raw(Model.TermsofUseContent)
                                                </div>
                                                <div class="teacherRegistration-terms-argree">
                                                    @Html.CheckBoxFor(x => x.TermsofUse, new { tabindex = 10, id = "idchbTermsOfUse" })
                                                    @Html.ValidationMessageFor(x => x.MessageError, " ")
                                                    <label for="idchbTermsOfUse"> I agree to the Terms of Use *</label>
                                                </div>

                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <div class="u-text-right">
                                    <button id="btnCancel" onclick="history.go(-1);">Cancel</button>
                                    <button id="btnRegister" onclick="RegisterTeacher();" disabled="disabled">Register</button>
                                </div>
                            </div>
                        }
                        else
                        {
                            <h1>Error Message</h1>
                            <p>@Model.MessageError</p>
                        }
                    </div>
                </div>
            </section>
            <div class="clear"></div>
            <section class="ten tenfix columns mainBottom">
                @if (!string.IsNullOrEmpty(vS3URL))
                {
                    WhiteHtmlInFolder = string.Format("{0}{1}/RegText.html", vS3URL, districtId);
                    var htmlContent = Html.DisplayStaticHtml(WhiteHtmlInFolder);
                    if (htmlContent == null || string.IsNullOrWhiteSpace(htmlContent.ToHtmlString()))
                    {
                        var whiteHtmlDefault = string.Format("{0}{1}.html", vS3URL, districtId);
                        htmlContent = Html.DisplayStaticHtml("");
                    }
                    <div>@htmlContent</div>
                }
            </section>

        </article>
    </div>
    <div class="clear"></div>
    @*<link rel="stylesheet" href="http://s3.amazonaws.com/LinkIt-CSS/Portal/Vina/272.css"/>*@
    <link rel="stylesheet" href="@strWhiteLable" />
</body>
</html>
